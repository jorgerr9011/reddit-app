from django.shortcuts import render
import pandas as pd
import requests
from textblob import TextBlob


def map_view(request):
    # Definir los datos de los países y sus subreddits
    countries = [
        #------------------------------------------------Europa----------------------------------------------------------------------------------------
        {"name": "Albania", "lat": 41.3275, "lng": 19.8187, "subreddit": "r/Albania"},
        {"name": "Alemania", "lat": 51.1657, "lng": 10.4515, "subreddit": "r/de"},
        {"name": "Andorra", "lat": 42.5063, "lng": 1.5218, "subreddit": "r/Andorra"},
        {"name": "Armenia", "lat": 40.0691, "lng": 45.0382, "subreddit": "r/Armenia"},
        {"name": "Austria", "lat": 47.5162, "lng": 14.5501, "subreddit": "r/Austria"},
        {"name": "Azerbaiyán", "lat": 40.1431, "lng": 47.5769, "subreddit": "r/Azerbaijan"},
        {"name": "Bélgica", "lat": 50.5039, "lng": 4.4699, "subreddit": "r/belgium"},
        {"name": "Bielorrusia", "lat": 53.7098, "lng": 27.9534, "subreddit": "r/belarus"},
        {"name": "Bosnia y Herzegovina", "lat": 43.9159, "lng": 17.6791, "subreddit": "r/bih"},
        {"name": "Bulgaria", "lat": 42.7339, "lng": 25.4858, "subreddit": "r/Bulgaria"},
        {"name": "Chipre", "lat": 35.1264, "lng": 33.4299, "subreddit": "r/cyprus"},
        {"name": "Ciudad del Vaticano", "lat": 41.9029, "lng": 12.4534, "subreddit": "r/vatican"},
        {"name": "Croacia", "lat": 45.1, "lng": 15.2000, "subreddit": "r/croatia"},
        {"name": "Dinamarca", "lat": 56.2639, "lng": 9.5018, "subreddit": "r/Denmark"},
        {"name": "Eslovaquia", "lat": 48.6690, "lng": 19.6990, "subreddit": "r/Slovakia"},
        {"name": "Eslovenia", "lat": 46.1512, "lng": 14.9955, "subreddit": "r/Slovenia"},
        {"name": "España", "lat": 40.4637, "lng": -3.7492, "subreddit": "r/spain"},
        {"name": "Estonia", "lat": 58.5953, "lng": 25.0136, "subreddit": "r/Eesti"},
        {"name": "Finlandia", "lat": 61.9241, "lng": 25.7482, "subreddit": "r/Suomi"},
        {"name": "Francia", "lat": 46.6031, "lng": 1.8883, "subreddit": "r/france"},
        {"name": "Georgia", "lat": 42.3154, "lng": 43.3569, "subreddit": "r/Sakartvelo"},
        {"name": "Grecia", "lat": 39.0742, "lng": 21.8243, "subreddit": "r/greece"},
        {"name": "Hungría", "lat": 47.1625, "lng": 19.5033, "subreddit": "r/hungary"},
        {"name": "Irlanda", "lat": 53.4129, "lng": -8.2439, "subreddit": "r/ireland"},
        {"name": "Islandia", "lat": 64.9631, "lng": -19.0208, "subreddit": "r/iceland"},
        {"name": "Italia", "lat": 41.8719, "lng": 12.5674, "subreddit": "r/italy"},
        {"name": "Kazajistán", "lat": 48.0196, "lng": 66.9237, "subreddit": "r/Kazakhstan"},
        {"name": "Letonia", "lat": 56.8796, "lng": 24.6032, "subreddit": "r/latvia"},
        {"name": "Liechtenstein", "lat": 47.1660, "lng": 9.5554, "subreddit": "r/Liechtenstein"},
        {"name": "Lituania", "lat": 55.1694, "lng": 23.8813, "subreddit": "r/lithuania"},
        {"name": "Luxemburgo", "lat": 49.8153, "lng": 6.1296, "subreddit": "r/Luxembourg"},
        {"name": "Macedonia del Norte", "lat": 41.6086, "lng": 21.7453, "subreddit": "r/mkd"},
        {"name": "Malta", "lat": 35.9375, "lng": 14.3754, "subreddit": "r/malta"},
        {"name": "Moldavia", "lat": 47.4116, "lng": 28.3699, "subreddit": "r/moldova"},
        {"name": "Mónaco", "lat": 43.7384, "lng": 7.4246, "subreddit": "r/Monaco"},
        {"name": "Montenegro", "lat": 42.7087, "lng": 19.3744, "subreddit": "r/montenegro"},
        {"name": "Noruega", "lat": 60.4720, "lng": 8.4689, "subreddit": "r/norge"},
        {"name": "Países Bajos", "lat": 52.1326, "lng": 5.2913, "subreddit": "r/thenetherlands"},
        {"name": "Polonia", "lat": 51.9194, "lng": 19.1451, "subreddit": "r/Polska"},
        {"name": "Portugal", "lat": 39.3999, "lng": -8.2245, "subreddit": "r/portugal"},
        {"name": "Reino Unido", "lat": 55.3781, "lng": -3.4360, "subreddit": "r/unitedkingdom"},
        {"name": "República Checa", "lat": 49.8175, "lng": 15.4730, "subreddit": "r/czech"},
        {"name": "Rumanía", "lat": 45.9432, "lng": 24.9668, "subreddit": "r/Romania"},
        {"name": "Rusia", "lat": 61.5240, "lng": 105.3188, "subreddit": "r/russia"},
        {"name": "San Marino", "lat": 43.9424, "lng": 12.4578, "subreddit": "r/sanmarino"},
        {"name": "Serbia", "lat": 44.0165, "lng": 21.0059, "subreddit": "r/serbia"},
        {"name": "Suecia", "lat": 60.1282, "lng": 18.6435, "subreddit": "r/sweden"},
        {"name": "Suiza", "lat": 46.8182, "lng": 8.2275, "subreddit": "r/Switzerland"},
        {"name": "Turquía", "lat": 38.9637, "lng": 35.2433, "subreddit": "r/Turkey"},
        {"name": "Ucrania", "lat": 48.3794, "lng": 31.1656, "subreddit": "r/ukraine"},
    

        #---------------------------------------------------------America--------------------------------------
        {"name": "Estados Unidos", "lat": 37.0902, "lng": -95.7129, "subreddit": "r/USA"},
        {"name": "Canadá", "lat": 56.1304, "lng": -106.3468, "subreddit": "r/Canada"},
        {"name": "Groenlandia", "lat": 72.0011, "lng": -40.9984, "subreddit": "r/Greenland"},
        {"name": "Cuba", "lat": 23.1136, "lng": -82.3666, "subreddit": "r/Cuba"},
        {"name": "Guatemala", "lat": 14.6349, "lng": -90.5069, "subreddit": "r/Guatemala"},
        {"name": "República Dominicana", "lat": 18.7357, "lng": -70.1627, "subreddit": "r/DominicanRepublic"},
        {"name": "Panamá", "lat": 8.5379, "lng": -80.7821, "subreddit": "r/Panama"},
        {"name": "Costa Rica", "lat": 9.7489, "lng": -83.7534, "subreddit": "r/CostaRica"},
        {"name": "Nicaragua", "lat": 12.8654, "lng": -85.2072, "subreddit": "r/Nicaragua"},
        { "name": "México", "lat": 21.4767, "lng": -102.6143, "subreddit": "r/Mexico" },
        { "name": "Venezuela", "lat": 8.0434, "lng": -65.5743, "subreddit": "r/Venezuela" },
        { "name": "Brasil", "lat": -7.7852, "lng": -55.4142, "subreddit": "r/Brasil" },
        { "name": "Colombia", "lat": 2.5517, "lng": -71.83188, "subreddit": "r/Colombia" },
        { "name": "Perú", "lat": -8.3182, "lng": -75.4652, "subreddit": "r/Peru" },
        { "name": "Bolivia", "lat": -17.1683, "lng": -64.0267, "subreddit": "r/Bolivia" },
        { "name": "Chile", "lat": -23.7822, "lng": -69.6114, "subreddit": "r/Chile" },
        { "name": "Argentina", "lat": -34.6037, "lng": -58.3816, "subreddit": "r/Argentina"},
        { "name": "Uruguay", "lat": -34.9011, "lng": -56.1645, "subreddit": "r/Uruguay"},
        { "name": "Paraguay", "lat": -25.2637, "lng": -57.5759, "subreddit": "r/Paraguay"},
        { "name": "Surinam", "lat": 5.8520, "lng": -55.2038, "subreddit": "r/Surinam"},


        #----------------------------------------------------------Asia---------------------------------------------------------------
        {"name": "Afganistán", "lat": 33.9391, "lng": 67.7100, "subreddit": "r/afghanistan"},
        {"name": "Arabia Saudita", "lat": 23.8859, "lng": 45.0792, "subreddit": "r/saudiarabia"},
        {"name": "Armenia", "lat": 40.0691, "lng": 45.0382, "subreddit": "r/armenia"},
        {"name": "Azerbaiyán", "lat": 40.1431, "lng": 47.5769, "subreddit": "r/azerbaijan"},
        {"name": "Bangladés", "lat": 23.6850, "lng": 90.3563, "subreddit": "r/bangladesh"},
        {"name": "Baréin", "lat": 26.0667, "lng": 50.5577, "subreddit": "r/bahrain"},
        {"name": "Birmania / Myanmar", "lat": 21.9162, "lng": 95.9560, "subreddit": "r/myanmar"},
        {"name": "Brunéi", "lat": 4.5353, "lng": 114.7277, "subreddit": "r/brunei"},
        {"name": "Bután", "lat": 27.5142, "lng": 90.4336, "subreddit": "r/bhutan"},
        {"name": "Camboya", "lat": 12.5657, "lng": 104.9910, "subreddit": "r/cambodia"},
        {"name": "Catar", "lat": 25.3548, "lng": 51.1839, "subreddit": "r/qatar"},
        {"name": "China", "lat": 35.8617, "lng": 104.1954, "subreddit": "r/china"},
        {"name": "Chipre", "lat": 35.1264, "lng": 33.4299, "subreddit": "r/cyprus"},
        {"name": "Corea del Norte", "lat": 40.3399, "lng": 127.5101, "subreddit": "r/northkorea"},
        {"name": "Corea del Sur", "lat": 35.9078, "lng": 127.7669, "subreddit": "r/southkorea"},
        {"name": "Emiratos Árabes Unidos", "lat": 23.4241, "lng": 53.8478, "subreddit": "r/uae"},
        {"name": "Filipinas", "lat": 12.8797, "lng": 121.7740, "subreddit": "r/philippines"},
        {"name": "Georgia", "lat": 42.3154, "lng": 43.3569, "subreddit": "r/georgia"},
        {"name": "India", "lat": 20.5937, "lng": 78.9629, "subreddit": "r/india"},
        {"name": "Indonesia", "lat": -0.7893, "lng": 113.9213, "subreddit": "r/indonesia"},
        {"name": "Irak", "lat": 33.3152, "lng": 44.3661, "subreddit": "r/iraq"},
        {"name": "Irán", "lat": 32.4279, "lng": 53.6880, "subreddit": "r/iran"},
        {"name": "Israel", "lat": 31.0461, "lng": 34.8516, "subreddit": "r/israel"},
        {"name": "Japón", "lat": 36.2048, "lng": 138.2529, "subreddit": "r/japan"},
        {"name": "Jordania", "lat": 30.5852, "lng": 36.2384, "subreddit": "r/jordan"},
        {"name": "Kazajistán", "lat": 48.0196, "lng": 66.9237, "subreddit": "r/kazakhstan"},
        {"name": "Kirguistán", "lat": 41.2044, "lng": 74.7661, "subreddit": "r/kyrgyzstan"},
        {"name": "Kuwait", "lat": 29.3117, "lng": 47.4818, "subreddit": "r/kuwait"},
        {"name": "Laos", "lat": 19.8563, "lng": 102.4955, "subreddit": "r/laos"},
        {"name": "Líbano", "lat": 33.8547, "lng": 35.8623, "subreddit": "r/lebanon"},
        {"name": "Malasia", "lat": 4.2105, "lng": 101.9758, "subreddit": "r/malaysia"},
        {"name": "Maldivas", "lat": 3.2028, "lng": 73.2207, "subreddit": "r/maldives"},
        {"name": "Mongolia", "lat": 46.8625, "lng": 103.8467, "subreddit": "r/mongolia"},
        {"name": "Nepal", "lat": 28.3949, "lng": 84.1240, "subreddit": "r/nepal"},
        {"name": "Omán", "lat": 21.4735, "lng": 55.9754, "subreddit": "r/oman"},
        {"name": "Pakistán", "lat": 30.3753, "lng": 69.3451, "subreddit": "r/pakistan"},
        {"name": "Singapur", "lat": 1.3521, "lng": 103.8198, "subreddit": "r/singapore"},
        {"name": "Siria", "lat": 34.8021, "lng": 38.9968, "subreddit": "r/syria"},
        {"name": "Sri Lanka", "lat": 7.8731, "lng": 80.7718, "subreddit": "r/srilanka"},
        {"name": "Tailandia", "lat": 15.8700, "lng": 100.9925, "subreddit": "r/thailand"},
        {"name": "Tayikistán", "lat": 38.8610, "lng": 71.2761, "subreddit": "r/tajikistan"},
        {"name": "Timor Oriental", "lat": -8.8742, "lng": 125.7275, "subreddit": "r/timorleste"},
        {"name": "Turkmenistán", "lat": 38.9697, "lng": 59.5563, "subreddit": "r/turkmenistan"},
        {"name": "Turquía", "lat": 38.9637, "lng": 35.2433, "subreddit": "r/turkey"},
        {"name": "Uzbekistán", "lat": 41.3775, "lng": 64.5853, "subreddit": "r/uzbekistan"},
        {"name": "Vietnam", "lat": 14.0583, "lng": 108.2772, "subreddit": "r/vietnam"},
        {"name": "Yemen", "lat": 15.5527, "lng": 48.5164, "subreddit": "r/yemen"},

        #------------------------------------------Africa----------------------------------------------------------------------
        {"name": "Angola", "lat": -11.2027, "lng": 17.8739, "subreddit": "r/angola"},
        {"name": "Argelia", "lat": 28.0339, "lng": 1.6596, "subreddit": "r/algeria"},
        {"name": "Benín", "lat": 9.3077, "lng": 2.3158, "subreddit": "r/benin"},
        {"name": "Botsuana", "lat": -22.3285, "lng": 24.6849, "subreddit": "r/botswana"},
        {"name": "Burkina Faso", "lat": 12.2383, "lng": -1.5616, "subreddit": "r/burkinafaso"},
        {"name": "Burundi", "lat": -3.3731, "lng": 29.9189, "subreddit": "r/burundi"},
        {"name": "Cabo Verde", "lat": 16.5388, "lng": -23.0418, "subreddit": "r/CapeVerde"},
        {"name": "Camerún", "lat": 7.3697, "lng": 12.3547, "subreddit": "r/cameroon"},
        {"name": "Chad", "lat": 15.4542, "lng": 18.7322, "subreddit": "r/chad"},
        {"name": "Comoras", "lat": -11.6455, "lng": 43.3333, "subreddit": "r/comoros"},
        {"name": "Costa de Marfil", "lat": 7.5400, "lng": -5.5471, "subreddit": "r/ivorycoast"},
        {"name": "Egipto", "lat": 26.8206, "lng": 30.8025, "subreddit": "r/egypt"},
        {"name": "Eritrea", "lat": 15.1794, "lng": 39.7823, "subreddit": "r/eritrea"},
        {"name": "Etiopía", "lat": 9.1450, "lng": 40.4897, "subreddit": "r/ethiopia"},
        {"name": "Gabón", "lat": -0.8037, "lng": 11.6094, "subreddit": "r/gabon"},
        {"name": "Gambia", "lat": 13.4432, "lng": -15.3101, "subreddit": "r/gambia"},
        {"name": "Ghana", "lat": 7.9465, "lng": -1.0232, "subreddit": "r/ghana"},
        {"name": "Guinea", "lat": 9.9456, "lng": -9.6966, "subreddit": "r/guinea"},
        {"name": "Guinea-Bisáu", "lat": 11.8037, "lng": -15.1804, "subreddit": "r/guineabissau"},
        {"name": "Guinea Ecuatorial", "lat": 1.6508, "lng": 10.2679, "subreddit": "r/equatorialguinea"},
        {"name": "Kenia", "lat": -1.2864, "lng": 36.8172, "subreddit": "r/kenya"},
        {"name": "Lesoto", "lat": -29.6099, "lng": 28.2336, "subreddit": "r/lesotho"},
        {"name": "Liberia", "lat": 6.4281, "lng": -9.4295, "subreddit": "r/liberia"},
        {"name": "Libia", "lat": 26.3351, "lng": 17.2283, "subreddit": "r/libya"},
        {"name": "Madagascar", "lat": -18.8792, "lng": 47.5079, "subreddit": "r/madagascar"},
        {"name": "Malaui", "lat": -13.2543, "lng": 34.3015, "subreddit": "r/malawi"},
        {"name": "Malí", "lat": 17.5707, "lng": -3.9962, "subreddit": "r/mali"},
        {"name": "Marruecos", "lat": 31.7917, "lng": -7.0926, "subreddit": "r/morocco"},
        {"name": "Mauricio", "lat": -20.3000, "lng": 57.5833, "subreddit": "r/mauritius"},
        {"name": "Mauritania", "lat": 21.0079, "lng": -10.9408, "subreddit": "r/mauritania"},
        {"name": "Mozambique", "lat": -18.6657, "lng": 35.5296, "subreddit": "r/mozambique"},
        {"name": "Namibia", "lat": -22.9576, "lng": 18.4904, "subreddit": "r/namibia"},
        {"name": "Níger", "lat": 17.6078, "lng": 8.0817, "subreddit": "r/niger"},
        {"name": "Nigeria", "lat": 9.0811, "lng": 8.6753, "subreddit": "r/nigeria"},
        {"name": "República Centroafricana", "lat": 6.6111, "lng": 20.9394, "subreddit": "r/centralafricanrep"},
        {"name": "República del Congo", "lat": -0.2280, "lng": 15.8277, "subreddit": "r/congobrazzaville"},
        {"name": "República del Congo", "lat": -0.2280, "lng": 15.8277, "subreddit": "r/congobrazzaville"},
        {"name": "República Democrática del Congo", "lat": -4.0383, "lng": 21.7587, "subreddit": "r/congodemocratic"},
        {"name": "Ruanda", "lat": -1.9403, "lng": 29.8739, "subreddit": "r/rwanda"},
        {"name": "Santo Tomé y Príncipe", "lat": 0.1864, "lng": 6.6131, "subreddit": "r/saotome"},
        {"name": "Senegal", "lat": 14.4974, "lng": -14.4524, "subreddit": "r/senegal"},
        {"name": "Seychelles", "lat": -4.6796, "lng": 55.4920, "subreddit": "r/seychelles"},
        {"name": "Sierra Leona", "lat": 8.4606, "lng": -11.7799, "subreddit": "r/sierraleone"},
        {"name": "Somalia", "lat": 5.1521, "lng": 46.1996, "subreddit": "r/somalia"},
        {"name": "Suazilandia", "lat": -26.5225, "lng": 31.4659, "subreddit": "r/eswatini"},
        {"name": "Sudáfrica", "lat": -30.5595, "lng": 22.9375, "subreddit": "r/southafrica"},
        {"name": "Sudán", "lat": 12.8628, "lng": 30.2176, "subreddit": "r/sudan"},
        {"name": "Sudán del Sur", "lat": 6.8770, "lng": 31.3070, "subreddit": "r/southsudan"},
        {"name": "Tanzania", "lat": -6.3690, "lng": 34.8888, "subreddit": "r/tanzania"},
        {"name": "Togo", "lat": 8.6195, "lng": 0.8248, "subreddit": "r/togo"},
        {"name": "Túnez", "lat": 33.8869, "lng": 9.5375, "subreddit": "r/tunisia"},
        {"name": "Uganda", "lat": 1.3733, "lng": 32.2903, "subreddit": "r/uganda"},
        {"name": "Yibuti", "lat": 11.8251, "lng": 42.5903, "subreddit": "r/djibouti"},
        {"name": "Zambia", "lat": -13.1339, "lng": 27.8493, "subreddit": "r/zambia"},
        {"name": "Zimbabue", "lat": -19.0154, "lng": 29.1549, "subreddit": "r/Zimbabwe"},

        #------------------------Oceania-------------------------------------------------------------
        {"name": "Australia", "lat": -25.2744, "lng": 133.7751, "subreddit": "r/Australia"},
        {"name": "Nueva Zelanda", "lat": -40.9006, "lng": 174.8860, "subreddit": "r/NewZealand"},
        {"name": "Papúa Nueva Guinea", "lat": -6.3149, "lng": 143.9555, "subreddit": "r/PapuaNewGuinea"}
       
        

    ]

    # Crear una lista para almacenar los marcadores
    markers = []

    # Agregar marcadores y enlaces para cada país
    for country in countries:
        marker = {
            "lat": country["lat"],
            "lng": country["lng"],
            "popup": f'<a href="https://www.reddit.com/{country["subreddit"]}" target="_blank">{country["subreddit"]}</a>',
        }
        markers.append(marker)

    # Renderizar la plantilla con los datos de los países y los marcadores
    context = {"countries": countries, "markers": markers}
    return render(request, "googlemaps/map.html", context)



